{"version":3,"file":"forum.js","mappings":"MACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CAAM,ECLdF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDR,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,I,mBCAlF,MAAM,EAA+BI,OAAOC,IAAIP,IAAI,OAAQ,c,MCC5D,gBAAiBQ,IAAI,+BAA+B,KAClDC,QAAQC,IAAI,4DAA4D,ICF1E,MAAM,EAA+BJ,OAAOC,IAAIP,IAAI,OAAQ,a,aCA5D,MAAM,EAA+BM,OAAOC,IAAIP,IAAI,OAAQ,iBCAtD,EAA+BM,OAAOC,IAAIP,IAAI,OAAQ,6B,aCA5D,MAAM,EAA+BM,OAAOC,IAAIP,IAAI,OAAQ,gC,aCA5D,MAAM,EAA+BM,OAAOC,IAAIP,IAAI,OAAQ,a,aCA5D,MAAM,EAA+BM,OAAOC,IAAIP,IAAI,OAAQ,O,aCA5D,MAAM,EAA+BM,OAAOC,IAAIP,IAAI,OAAQ,+B,aCA5D,MAAM,EAA+BM,OAAOC,IAAIP,IAAI,OAAQ,qB,aCA5D,MAAM,EAA+BM,OAAOC,IAAIP,IAAI,OAAQ,mB,aCA5D,MAAM,EAA+BM,OAAOC,IAAIP,IAAI,OAAQ,kB,aCA5D,MAAM,EAA+BM,OAAOC,IAAIP,IAAI,OAAQ,oB,aCI7C,MAAMW,UAAgC,KACnD,IAAAC,GACE,MAAM,iBACJC,GACEC,KAAKC,MACHC,EAAaH,EAAiBG,aAC9BC,EAAQJ,EAAiBI,QACzBC,EAAaL,EAAiBK,aAC9BC,EAAUN,EAAiBO,KAE3BC,GADYR,EAAiBS,OAChBT,EAAiBQ,cAC9BE,EAAeV,EAAiBU,eAChCC,EAAYX,EAAiBW,YAC7BC,EAAYC,IAAIC,WAAWC,MAAkC,MAA5Bf,EAAiBgB,OAAiB,+CAAiD,+CACpHC,EAA6C,MAA5BjB,EAAiBgB,OAAiB,YAAc,cACvE,OAAOE,EAAE,MAAO,CACdC,UAAW,4BACVD,EAAE,MAAO,CACVE,MAAO,qBACNF,EAAE,IAAK,KAAML,IAAIC,WAAWC,MAAM,sDAAuD,MAAOG,EAAE,OAAQ,CAC3GE,MAAOH,GACNL,GAAY,MAAaM,EAAE,IAAK,KAAML,IAAIC,WAAWC,MAAM,2DAA4D,MAAOZ,GAAae,EAAE,MAAO,CACrJE,MAAO,qBACNF,EAAE,IAAK,KAAML,IAAIC,WAAWC,MAAM,oDAAqD,MAAOT,EAAS,MAAaY,EAAE,IAAK,KAAML,IAAIC,WAAWC,MAAM,2DAA4D,MAAOG,EAAE,IAAM,CAClOG,KAAM,IACNF,UAAW,mBACXC,MAAO,8BACN,IAAOZ,GAAa,IAAK,IAASA,IAAc,MAAaU,EAAE,IAAK,KAAML,IAAIC,WAAWC,MAAM,wDAAyD,MAAOX,EAAO,MAAac,EAAE,IAAK,KAAML,IAAIC,WAAWC,MAAM,yDAA0D,MAAOL,EAAc,MAAkBC,EAAW,MAAaO,EAAE,OAAQ,KAAMA,EAAE,IAAK,KAAML,IAAIC,WAAWC,MAAM,gEAAiE,MAAOV,IAC7c,EAEFZ,OAAOC,IAAIC,IAAI,uBAAwB,wCAAyCG,GC7BjE,MAAMwB,UAA4B,KAC/C,MAAAC,CAAOC,GACLC,MAAMF,OAAOC,GACbvB,KAAKyB,SAAU,EACfzB,KAAK0B,aAAc,EACnB1B,KAAKD,iBAAmB,GACxBC,KAAKQ,KAAOR,KAAKC,MAAM0B,OAAOnB,KAC9BR,KAAK4B,aACP,CACA,IAAA9B,GACE,IAAI2B,EAMJ,OALIzB,KAAKyB,UACPA,EAAU,cAA2B,CACnCI,KAAM,WAGHZ,EAAE,MAAO,KAAMA,EAAE,MAAO,CAC7BE,MAAO,2DACN,eAAeL,MAAM,sCAAuCG,EAAE,KAAM,CACrEE,MAAO,kEACNnB,KAAKD,iBAAiB+B,KAAI/B,GACpBkB,EAAE,KAAM,CACbE,MAAO,kBACPtC,IAAKkB,EAAiBO,GACtB,UAAWP,EAAiBO,IAC3B,EAAqByB,UAAU,CAChChC,0BAEEC,KAAKyB,SAA4C,IAAjCzB,KAAKD,iBAAiBiC,QAAgBf,EAAE,MAAO,KAAMA,EAAE,MAAO,CAClFE,MAAO,uGACN,eAAeL,MAAM,4CAA6Cd,KAAKiC,kBAAoBhB,EAAE,MAAO,CACrGE,MAAO,kCACNF,EAAE,IAAQ,CACXC,UAAW,yBACXgB,SAAUlC,KAAKyB,QACfA,QAASzB,KAAKyB,QACdU,QAAS,IAAMnC,KAAKoC,YACnB,eAAetB,MAAM,sDAC1B,CACA,QAAAsB,GACEpC,KAAKyB,SAAU,EACfzB,KAAK4B,YAAY5B,KAAKD,iBAAiBiC,OACzC,CACA,YAAAK,CAAaC,GAKX,OAJAtC,KAAK0B,cAAgBY,EAAQC,QAAQC,SAAWF,EAAQC,QAAQC,MAAMC,KACtE,GAAGC,KAAKC,MAAM3C,KAAKD,iBAAkBuC,GACrCtC,KAAKyB,SAAU,EACfR,EAAE2B,SACKN,CACT,CACA,cAAAL,GACE,OAAOjC,KAAK0B,WACd,CACA,WAAAE,CAAYiB,QACK,IAAXA,IACFA,EAAS,GAEX,IAAIC,EAAM,UAAY9C,KAAKQ,KAAKF,KAAO,iBACvC,OAAO,UAAUyC,KAAKD,EAAK,CACzBE,OAAQ,CACNxC,KAAMR,KAAKQ,KAAKF,MAElB2C,KAAM,CACJJ,YAEDK,OAAM,SAAUC,KAAKnD,KAAKqC,aAAae,KAAKpD,MACjD,EAEFR,OAAOC,IAAIC,IAAI,uBAAwB,oCAAqC2B,GCvE7D,MAAMgC,UAAyB,KAC5C,MAAA/B,CAAOC,GACLC,MAAMF,OAAOC,GACbvB,KAAKsD,SAASrC,EAAEsC,MAAMC,MAAM,YAC9B,CACA,OAAAC,GACE,OAAOxC,EAAE,MAAO,CACdC,UAAW,aACV,EAAiBa,UAAU,CAC5BJ,OAAQ,CACNnB,KAAMR,KAAKQ,QAGjB,EAEFhB,OAAOC,IAAIC,IAAI,uBAAwB,oCAAqC2D,GCjB5E,MAAM,EAA+B7D,OAAOC,IAAIP,IAAI,OAAQ,gB,aCC7C,MAAMwE,UAAyB,MAC9C3E,OAAO4E,OAAOD,EAAiBrE,UAAW,CACxC0B,KAAM,cAAgB,QACtBZ,MAAO,cAAgB,SACvBC,WAAY,cAAgB,eAC5BF,WAAY,cAAgB,eAC5BO,aAAc,cAAgB,iBAC9BC,UAAW,cAAgB,cAC3BF,KAAM,WAAa,QACnBD,WAAY,WAAa,gBAE3Bf,OAAOC,IAAIC,IAAI,uBAAwB,gCAAiCgE,GCNxE,iBAAiBhE,IAAI,4BAA4B,KAC/C,UAAUkE,OAAO7D,iBAAmB2D,EACpC,WAAW3D,iBAAmB,CAC5B8D,KAAM,6BACN9B,UAAWsB,IAEb,IAAAS,QAAO,cAAoB,YAAY,SAAUC,GACtB,OAArB,YAAYvD,OAGZ,YAAYA,KAAKF,OAASN,KAAKQ,KAAKF,MACjCN,KAAKQ,MAASR,KAAKQ,KAAKwD,UAAU,gCAIzCD,EAAMrE,IAAI,mBAAoB,cAAqB,CACjD0B,KAAM,UAAU,mBAAoB,CAClC6C,SAAUjE,KAAKQ,KAAK0D,SAEtBC,KAAM,qBACL,eAAerD,MAAM,oCAC1B,GAAE,G","sources":["webpack://@ecss11/flarum-ext-money-history/webpack/bootstrap","webpack://@ecss11/flarum-ext-money-history/webpack/runtime/compat get default export","webpack://@ecss11/flarum-ext-money-history/webpack/runtime/define property getters","webpack://@ecss11/flarum-ext-money-history/webpack/runtime/hasOwnProperty shorthand","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'common/app')\"","webpack://@ecss11/flarum-ext-money-history/./src/common/index.ts","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'forum/app')\"","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'common/extend')\"","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'forum/components/UserPage')\"","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'common/components/LinkButton')\"","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'Component')\"","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'app')\"","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'components/LoadingIndicator')\"","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'components/Button')\"","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'components/Link')\"","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'helpers/avatar')\"","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'helpers/username')\"","webpack://@ecss11/flarum-ext-money-history/./src/forum/components/MoneyHistoryListItem.js","webpack://@ecss11/flarum-ext-money-history/./src/forum/components/MoneyHistoryList.js","webpack://@ecss11/flarum-ext-money-history/./src/forum/components/MoneyHistoryPage.js","webpack://@ecss11/flarum-ext-money-history/external root \"flarum.reg.get('core', 'common/Model')\"","webpack://@ecss11/flarum-ext-money-history/./src/forum/models/UserMoneyHistory.js","webpack://@ecss11/flarum-ext-money-history/./src/forum/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/app');","import app from 'flarum/common/app';\napp.initializers.add('ecss11-money-history-common', () => {\n  console.log('[ecss11/flarum-ext-money-history] Hello, forum and admin!');\n});","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/app');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extend');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/UserPage');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/LinkButton');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'Component');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'app');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'components/LoadingIndicator');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'components/Button');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'components/Link');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'helpers/avatar');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'helpers/username');","import Component from \"flarum/Component\";\nimport Link from \"flarum/components/Link\";\nimport avatar from \"flarum/helpers/avatar\";\nimport username from \"flarum/helpers/username\";\nexport default class TransferHistoryListItem extends Component {\n  view() {\n    const {\n      userMoneyHistory\n    } = this.attrs;\n    const changeTime = userMoneyHistory.changeTime();\n    const money = userMoneyHistory.money();\n    const sourceDesc = userMoneyHistory.sourceDesc();\n    const moneyID = userMoneyHistory.id();\n    const moneyUser = userMoneyHistory.user();\n    const createUser = userMoneyHistory.createUser();\n    const balanceMoney = userMoneyHistory.balanceMoney();\n    const lastMoney = userMoneyHistory.lastMoney();\n    const moneyType = app.translator.trans(userMoneyHistory.type() === 'D' ? \"mattoid-money-history.forum.record.money-out\" : \"mattoid-money-history.forum.record.money-in\");\n    const moneyTypeStyle = userMoneyHistory.type() === 'D' ? \"color:red\" : \"color:green\";\n    return m(\"div\", {\n      className: \"transferHistoryContainer\"\n    }, m(\"div\", {\n      style: \"padding-top: 5px;\"\n    }, m(\"b\", null, app.translator.trans('mattoid-money-history.forum.record.money-list-type'), \": \"), m(\"span\", {\n      style: moneyTypeStyle\n    }, moneyType), \"\\xA0|\\xA0\", m(\"b\", null, app.translator.trans('mattoid-money-history.forum.record.money-list-assign-at'), \": \"), changeTime), m(\"div\", {\n      style: \"padding-top: 5px;\"\n    }, m(\"b\", null, app.translator.trans('mattoid-money-history.forum.record.money-list-id'), \": \"), moneyID, \"\\xA0|\\xA0\", m(\"b\", null, app.translator.trans('mattoid-money-history.forum.record.money-list-from-user'), \": \"), m(Link, {\n      href: \"#\",\n      className: \"moneyHistoryUser\",\n      style: \"color:var(--heading-color)\"\n    }, avatar(createUser), \" \", username(createUser)), \"\\xA0|\\xA0\", m(\"b\", null, app.translator.trans('mattoid-money-history.forum.record.money-list-amount'), \": \"), money, \"\\xA0|\\xA0\", m(\"b\", null, app.translator.trans('mattoid-money-history.forum.record.money-list-balance'), \": \"), balanceMoney, \"\\xA0\\u2192\\xA0\", lastMoney, \"\\xA0|\\xA0\", m(\"span\", null, m(\"b\", null, app.translator.trans('mattoid-money-history.forum.record.money-list-transfer-notes'), \": \"), sourceDesc)));\n  }\n}\nflarum.reg.add('ecss11-money-history', 'forum/components/MoneyHistoryListItem', TransferHistoryListItem);","import Component from \"flarum/Component\";\nimport app from \"flarum/app\";\nimport LoadingIndicator from \"flarum/components/LoadingIndicator\";\nimport Button from \"flarum/components/Button\";\nimport MoneyHistoryListItem from \"./MoneyHistoryListItem\";\nexport default class TransferHistoryList extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.loading = true;\n    this.moreResults = false;\n    this.userMoneyHistory = [];\n    this.user = this.attrs.params.user;\n    this.loadResults();\n  }\n  view() {\n    let loading;\n    if (this.loading) {\n      loading = LoadingIndicator.component({\n        size: \"large\"\n      });\n    }\n    return m(\"div\", null, m(\"div\", {\n      style: \"padding-bottom:10px; font-size: 24px;font-weight: bold;\"\n    }, app.translator.trans(\"mattoid-money-history.forum.title\")), m(\"ul\", {\n      style: \"margin: 0;padding: 0;list-style-type: none;position: relative;\"\n    }, this.userMoneyHistory.map(userMoneyHistory => {\n      return m(\"li\", {\n        style: \"padding-top:5px\",\n        key: userMoneyHistory.id,\n        \"data-id\": userMoneyHistory.id\n      }, MoneyHistoryListItem.component({\n        userMoneyHistory\n      }));\n    })), !this.loading && this.userMoneyHistory.length === 0 && m(\"div\", null, m(\"div\", {\n      style: \"font-size:1.4em;color: var(--muted-more-color);text-align: center;height: 300px;line-height: 100px;\"\n    }, app.translator.trans(\"mattoid-money-history.forum.list-empty\"))), this.hasMoreResults() && m(\"div\", {\n      style: \"text-align:center;padding:20px\"\n    }, m(Button, {\n      className: 'Button Button--primary',\n      disabled: this.loading,\n      loading: this.loading,\n      onclick: () => this.loadMore()\n    }, app.translator.trans('mattoid-money-history.forum.money-list-load-more'))));\n  }\n  loadMore() {\n    this.loading = true;\n    this.loadResults(this.userMoneyHistory.length);\n  }\n  parseResults(results) {\n    this.moreResults = !!results.payload.links && !!results.payload.links.next;\n    [].push.apply(this.userMoneyHistory, results);\n    this.loading = false;\n    m.redraw();\n    return results;\n  }\n  hasMoreResults() {\n    return this.moreResults;\n  }\n  loadResults(offset) {\n    if (offset === void 0) {\n      offset = 0;\n    }\n    let url = '/users/' + this.user.id() + '/money/history';\n    return app.store.find(url, {\n      filter: {\n        user: this.user.id()\n      },\n      page: {\n        offset\n      }\n    }).catch(() => {}).then(this.parseResults.bind(this));\n  }\n}\nflarum.reg.add('ecss11-money-history', 'forum/components/MoneyHistoryList', TransferHistoryList);","import UserPage from 'flarum/forum/components/UserPage';\nimport MoneyHistoryList from \"./MoneyHistoryList\";\nexport default class MoneyHistoryPage extends UserPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.loadUser(m.route.param('username'));\n  }\n  content() {\n    return m(\"div\", {\n      className: \"Post-body\"\n    }, MoneyHistoryList.component({\n      params: {\n        user: this.user\n      }\n    }));\n  }\n}\nflarum.reg.add('ecss11-money-history', 'forum/components/MoneyHistoryPage', MoneyHistoryPage);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/Model');","import Model from 'flarum/common/Model';\nexport default class UserMoneyHistory extends Model {}\nObject.assign(UserMoneyHistory.prototype, {\n  type: Model.attribute('type'),\n  money: Model.attribute('money'),\n  sourceDesc: Model.attribute('source_desc'),\n  changeTime: Model.attribute('change_time'),\n  balanceMoney: Model.attribute('balance_money'),\n  lastMoney: Model.attribute('last_money'),\n  user: Model.hasOne('user'),\n  createUser: Model.hasOne('createUser')\n});\nflarum.reg.add('ecss11-money-history', 'forum/models/UserMoneyHistory', UserMoneyHistory);","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport MoneyHistoryPage from './components/MoneyHistoryPage';\nimport UserMoneyHistory from \"./models/UserMoneyHistory\";\napp.initializers.add('flarum-ext-money-history', () => {\n  app.store.models.userMoneyHistory = UserMoneyHistory;\n  app.routes.userMoneyHistory = {\n    path: '/u/:username/money/history',\n    component: MoneyHistoryPage\n  };\n  extend(UserPage.prototype, 'navItems', function (items) {\n    if (app.session.user === null) {\n      return;\n    }\n    if (app.session.user.id() !== this.user.id()) {\n      if (!this.user || !this.user.attribute('canQueryOthersMoneyHistory')) {\n        return;\n      }\n    }\n    items.add('userMoneyHistory', LinkButton.component({\n      href: app.route('userMoneyHistory', {\n        username: this.user.slug()\n      }),\n      icon: 'fas fa-money-bill'\n    }, app.translator.trans('mattoid-money-history.forum.nav')));\n  });\n});"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","reg","add","console","log","TransferHistoryListItem","view","userMoneyHistory","this","attrs","changeTime","money","sourceDesc","moneyID","id","createUser","user","balanceMoney","lastMoney","moneyType","app","translator","trans","type","moneyTypeStyle","m","className","style","href","TransferHistoryList","oninit","vnode","super","loading","moreResults","params","loadResults","size","map","component","length","hasMoreResults","disabled","onclick","loadMore","parseResults","results","payload","links","next","push","apply","redraw","offset","url","find","filter","page","catch","then","bind","MoneyHistoryPage","loadUser","route","param","content","UserMoneyHistory","assign","models","path","extend","items","attribute","username","slug","icon"],"sourceRoot":""}